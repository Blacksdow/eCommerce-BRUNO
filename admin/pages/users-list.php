<?php if($loggedInUser->is_admin ) : ?>
<?php 

$userMgr = new UserManager();
$users = $userMgr->getAll();

$userTypeMgr = new UserTypeManager();
$userTypes = $userTypeMgr->getAll();

if(isset($_POST['user_save_changes'])) {


    $user_id = htmlspecialchars(trim($_POST['user-id']));
    $user_type_id = htmlspecialchars(trim($_POST['user-type']));

    //UpdateDatabase
    $um = new UserManager();
  
    // aggiungi al database il prodotto aggiornato
    $um->updateUser($user_id,$user_type_id);
    
  }

if(isset($_POST['delete_user'])) {
 
    $user_id = htmlspecialchars(trim($_POST['user-id']));
    

    //UpdateDatabase
    $um = new UserManager();
  
    
    $um->deleteUserFromDatabase($user_id);
    
  }

?>


<?php if($users) : ?>
    <h2 class="lead" style="font-size:22pt ;">Gestione Utenti</h2>
    <div class="container-fluid">
        <?php foreach($users as $user) : ?>
        <form method="POST" action="">
            <div class="row mt-3">
                <input name="user-id" class="col-1" value="<?php echo $user->id ?>" readonly/>
                <input name="user-email" class="col-4" value="<?php echo $user->email ?>" readonly/>
                <select name="user-type" class="col-2">
                    <?php foreach($userTypes as $userType) : ?>
                        <OPTION value="<?php echo $userType->id ?>"  <?php if($userType->id == $user->user_type_id): ?> SELECTED <?php endif; ?>>
                        <?php echo $userType->name ?>
                        </OPTION>
                    <?php endforeach; ?>
                </select>
                <input type="submit" class="col-2" value="Salva Cambiamenti" name="user_save_changes">
                <input type="submit" class="bg-danger col-2" value="Cancella Utente" name="delete_user">
            </div>
        </form>
        <?php endforeach; ?>
    </div>
    
    
    <?php else : ?>
        <p>Nessun User disponibile al momento...</p>
<?php endif; ?>

<?php else : ?> 
<h1>Torna quando sarai un admin...</h1>
¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶______________¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___________________¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶______¶¶¶¶¶¶¶¶¶¶¶______¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶¶¶_____¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶_____¶¶¶¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶¶____¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶_____¶¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶____¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶____¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶____¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶
¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶
¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶
¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶
¶¶¶¶¶___¶¶¶_________¶¶¶¶¶¶¶¶¶¶¶¶¶¶___________¶¶¶__¶¶¶¶¶
¶¶¶¶¶__¶¶¶¶¶¶¶_______¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶_____¶¶¶¶¶¶___¶¶¶¶
¶¶¶¶___¶¶¶¶¶¶¶¶______¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶__¶¶¶¶
¶¶¶¶__¶¶¶¶¶¶¶¶¶¶______¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶___¶¶¶
¶¶¶___¶¶¶¶¶¶¶¶¶¶¶______¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶__¶¶¶
¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶_______¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶___¶¶
¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶________¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶__¶¶
¶¶___¶¶¶¶¶¶¶¶¶¶¶¶__¶_____¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶__¶¶
¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶_____¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶__¶¶
¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶______¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶__¶¶
¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶______¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶___¶
¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶______¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶__¶
¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶______¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶__¶
¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶_____¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶__¶
¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶______¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶__¶
¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶______¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶__¶
¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶______¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶__¶
¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶______¶¶¶¶___¶¶¶¶¶¶¶¶¶¶___¶
¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶_____¶¶¶¶___¶¶¶¶¶¶¶¶¶¶___¶
¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶______¶¶¶___¶¶¶¶¶¶¶¶¶¶__¶¶
¶¶___¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶______¶¶___¶¶¶¶¶¶¶¶¶¶__¶¶
¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶______¶¶__¶¶¶¶¶¶¶¶¶¶__¶¶
¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶_____¶¶__¶¶¶¶¶¶¶¶¶___¶¶
¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶¶________¶¶¶¶¶¶¶¶¶__¶¶¶
¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶¶________¶¶¶¶¶¶¶¶¶__¶¶¶
¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶_______¶¶¶¶¶¶¶¶___¶¶¶
¶¶¶¶___¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶______¶¶¶¶¶¶¶¶__¶¶¶¶
¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶_____¶¶¶¶¶¶¶___¶¶¶¶
¶¶¶¶¶___¶¶¶¶¶¶¶¶¶__¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶____¶¶¶¶¶¶¶__¶¶¶¶¶
¶¶¶¶¶¶___¶¶¶¶¶¶¶____¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶___¶¶¶¶¶
¶¶¶¶¶¶¶__¶¶¶¶__________¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶___¶¶¶¶¶¶
¶¶¶¶¶¶¶___¶¶___________¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶¶¶___¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶____¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶____¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶____¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶____¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶____¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶____¶¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶¶¶____¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶_____¶¶¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶_____¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶_____¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶________¶¶¶¶¶¶________¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶_________________¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶__________¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶
¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶
<?php endif; ?>